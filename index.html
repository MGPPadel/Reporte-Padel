<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Informe de Clases de Padel</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" referrerpolicy="no-referrer" />
  <!-- Librerías para exportar a PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
    body { font-family: 'Inter', sans-serif; }
    .btn-action {
      @apply bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-indigo-700 transition-colors;
    }
    .btn-export {
      @apply bg-red-600 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-red-700 transition-colors;
    }
    .btn-edit {
      @apply bg-yellow-500 text-white p-2 rounded-lg shadow-md hover:bg-yellow-600 transition-colors;
    }
    .btn-delete {
      @apply bg-red-500 text-white p-2 rounded-lg shadow-md hover:bg-red-600 transition-colors;
    }
    .btn-cancel {
      @apply bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg shadow-md hover:bg-gray-400 transition-colors;
    }
    .bg-custom-gradient {
      background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%);
    }
    .bg-custom-header {
      background-color: #3b82f6; /* Tailwind's blue-500 */
    }
    .header-text-white {
      color: white;
    }
    .card-list {
      display: grid;
      gap: 1rem;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    }
    .class-card {
      @apply bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-shadow border border-gray-200 flex flex-col justify-between;
    }
    .class-card-header {
      @apply flex justify-between items-start mb-4;
    }
  </style>
</head>
<body class="bg-custom-gradient min-h-screen flex items-center justify-center p-4">
  <div id="root"></div>

  <script type="text/babel">
    // Mismo código de configuración de Firebase y estados aquí
    // Se asume que el código de Firebase, useState, useEffect, etc. está aquí

    // Código de Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInWithCustomToken, onAuthStateChanged, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, deleteDoc, onSnapshot, collection, query, where, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    const { useState, useEffect } = React;

    // Configuración global de Firebase, si está disponible
    const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
    const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
    const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

    let app, auth, db;
    if (Object.keys(firebaseConfig).length > 0) {
      app = initializeApp(firebaseConfig);
      auth = getAuth(app);
      db = getFirestore(app);
    } else {
      console.warn("Firebase config not available. App will run without data persistence.");
    }
    
    // Función para convertir PCM a WAV (necesaria para TTS)
    const pcmToWav = (pcmData, sampleRate = 16000) => {
        const pcm16 = pcmData;
        const numChannels = 1;
        const sampleRateHz = sampleRate;
        const bytesPerSample = 2; // 16-bit
        const blockAlign = numChannels * bytesPerSample;
        const byteRate = sampleRateHz * blockAlign;
        const dataSize = pcm16.length * bytesPerSample;
        const buffer = new ArrayBuffer(44 + dataSize);
        const view = new DataView(buffer);
        let offset = 0;

        const writeString = (str) => {
            for (let i = 0; i < str.length; i++) {
                view.setUint8(offset++, str.charCodeAt(i));
            }
        };

        // RIFF header
        writeString('RIFF');
        view.setUint32(offset, 36 + dataSize, true);
        offset += 4;
        writeString('WAVE');
        offset += 4;

        // fmt sub-chunk
        writeString('fmt ');
        offset += 4;
        view.setUint32(offset, 16, true);
        offset += 4;
        view.setUint16(offset, 1, true);
        offset += 2;
        view.setUint16(offset, numChannels, true);
        offset += 2;
        view.setUint32(offset, sampleRateHz, true);
        offset += 4;
        view.setUint32(offset, byteRate, true);
        offset += 4;
        view.setUint16(offset, blockAlign, true);
        offset += 2;
        view.setUint16(offset, bytesPerSample * 8, true);
        offset += 2;

        // data sub-chunk
        writeString('data');
        offset += 4;
        view.setUint32(offset, dataSize, true);
        offset += 4;

        // Write PCM data
        for (let i = 0; i < pcm16.length; i++) {
            view.setInt16(offset, pcm16[i], true);
            offset += 2;
        }

        return new Blob([view], { type: 'audio/wav' });
    };

    // Función para convertir base64 a ArrayBuffer
    const base64ToArrayBuffer = (base64) => {
        const binaryString = atob(base64);
        const len = binaryString.length;
        const bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binaryString.charCodeAt(i);
        }
        return bytes.buffer;
    };

    const App = () => {
      const [entries, setEntries] = useState([]);
      const [isEditing, setIsEditing] = useState(false);
      const [editingId, setEditingId] = useState(null);
      const [newEntry, setNewEntry] = useState({
        studentCount: 1,
        studentNames: [''],
        date: new Date().toISOString().split('T')[0],
        day: '',
        time: 'Mañana',
        price: 0,
      });
      const [totalIncome, setTotalIncome] = useState(0);
      const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);
      const [loading, setLoading] = useState(true);
      const [userId, setUserId] = useState(null);
      const [isAuthReady, setIsAuthReady] = useState(false);
      const [showModal, setShowModal] = useState(false);
      const [modalContent, setModalContent] = useState('');
      const [modalAction, setModalAction] = useState(null);
      const [showReport, setShowReport] = useState(false);
      const [reportDates, setReportDates] = useState({ startDate: '', endDate: '' });
      const [reportData, setReportData] = useState({ totalIncome: 0, classCount: 0, entries: [] });
      const [isGeneratingPdf, setIsGeneratingPdf] = useState(false);

      const timesOfDay = ['Mañana', 'Tarde', 'Noche'];
      const daysOfWeek = ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo'];

      // Autenticación de Firebase
      useEffect(() => {
        if (!auth) {
          setIsAuthReady(true);
          return;
        }
        const unsub = onAuthStateChanged(auth, async (user) => {
          if (!user) {
            try {
              await (initialAuthToken ? signInWithCustomToken(auth, initialAuthToken) : signInAnonymously(auth));
            } catch (error) {
              console.error("Error signing in:", error);
            }
          }
          if (auth.currentUser) {
            setUserId(auth.currentUser.uid);
          }
          setIsAuthReady(true);
        });
        return () => unsub();
      }, []);

      // Escuchar cambios en la base de datos en tiempo real
      useEffect(() => {
        if (!db || !isAuthReady || !userId) return;
        const entriesCollection = collection(db, `/artifacts/${appId}/users/${userId}/padel-classes`);
        const q = query(entriesCollection, where('date', '==', selectedDate));

        const unsub = onSnapshot(q, (snapshot) => {
          const fetchedEntries = snapshot.docs.map(doc => ({
            id: doc.id,
            ...doc.data()
          }));
          setEntries(fetchedEntries);
          const income = fetchedEntries.reduce((sum, entry) => sum + (entry.price || 0), 0);
          setTotalIncome(income);
          setLoading(false);
        }, (error) => {
          console.error("Error fetching data:", error);
          setLoading(false);
        });

        return () => unsub();
      }, [db, isAuthReady, userId, selectedDate]);

      const showConfirmationModal = (message, action) => {
        setModalContent(message);
        setModalAction(() => action);
        setShowModal(true);
      };

      const handleConfirm = () => {
        if (modalAction) {
          modalAction();
        }
        setShowModal(false);
        setModalAction(null);
      };

      const handleCancel = () => {
        setShowModal(false);
        setModalAction(null);
      };

      const handleInputChange = (e) => {
        const { name, value } = e.target;
        if (name.startsWith('student-name-')) {
          const index = parseInt(name.split('-')[2], 10);
          const newNames = [...newEntry.studentNames];
          newNames[index] = value;
          setNewEntry({ ...newEntry, studentNames: newNames });
        } else {
          setNewEntry({ ...newEntry, [name]: value });
        }
      };

      const handleStudentCountChange = (e) => {
        const count = parseInt(e.target.value, 10);
        if (count >= 1 && count <= 5) {
          const newNames = Array(count).fill('');
          setNewEntry({ ...newEntry, studentCount: count, studentNames: newNames });
        }
      };

      const addClass = async () => {
        if (newEntry.studentNames.some(name => !name.trim()) || newEntry.price <= 0) {
          showConfirmationModal("Por favor, completa todos los campos y asegúrate de que el precio sea mayor que 0.", null);
          return;
        }

        try {
          if (isEditing) {
            const entryDoc = doc(db, `/artifacts/${appId}/users/${userId}/padel-classes`, editingId);
            await updateDoc(entryDoc, newEntry);
            showConfirmationModal("Clase actualizada con éxito.", null);
            setIsEditing(false);
            setEditingId(null);
          } else {
            const entriesCollection = collection(db, `/artifacts/${appId}/users/${userId}/padel-classes`);
            await addDoc(entriesCollection, newEntry);
            showConfirmationModal("Clase añadida con éxito.", null);
          }
          setNewEntry({
            studentCount: 1,
            studentNames: [''],
            date: new Date().toISOString().split('T')[0],
            day: '',
            time: timesOfDay[0],
            price: 0
          });
        } catch (error) {
          console.error("Error al guardar la clase:", error);
          showConfirmationModal("Hubo un error al guardar la clase. Por favor, inténtalo de nuevo.", null);
        }
      };

      const editClass = (entry) => {
        setNewEntry({ ...entry });
        setIsEditing(true);
        setEditingId(entry.id);
      };

      const deleteClass = (id) => {
        showConfirmationModal("¿Estás seguro de que quieres eliminar esta clase?", async () => {
          try {
            await deleteDoc(doc(db, `/artifacts/${appId}/users/${userId}/padel-classes`, id));
            showConfirmationModal("Clase eliminada con éxito.", null);
          } catch (error) {
            console.error("Error al eliminar la clase:", error);
            showConfirmationModal("Hubo un error al eliminar la clase. Por favor, inténtalo de nuevo.", null);
          }
        });
      };
      
      const generateReport = async () => {
        if (!reportDates.startDate || !reportDates.endDate) {
          showConfirmationModal("Por favor, selecciona un rango de fechas válido.", null);
          return;
        }

        try {
          const entriesCollection = collection(db, `/artifacts/${appId}/users/${userId}/padel-classes`);
          const q = query(entriesCollection);
          const querySnapshot = await getDocs(q);

          const allEntries = querySnapshot.docs.map(doc => ({
            id: doc.id,
            ...doc.data()
          }));

          const filteredEntries = allEntries.filter(entry => {
            return entry.date >= reportDates.startDate && entry.date <= reportDates.endDate;
          });

          const total = filteredEntries.reduce((sum, entry) => sum + (entry.price || 0), 0);
          setReportData({
            totalIncome: total,
            classCount: filteredEntries.length,
            entries: filteredEntries
          });
          setShowReport(true);
        } catch (error) {
          console.error("Error al generar el informe:", error);
          showConfirmationModal("Hubo un error al generar el informe. Por favor, inténtalo de nuevo.", null);
        }
      };

      const generatePDF = () => {
        setIsGeneratingPdf(true);
        const element = document.getElementById('report-content');
        if (!element) {
          console.error("Elemento del informe no encontrado para generar PDF.");
          setIsGeneratingPdf(false);
          return;
        }
        
        html2canvas(element, {
            scale: 2,
            useCORS: true
        }).then((canvas) => {
            const imgData = canvas.toDataURL('image/png');
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();
            const imgProps = pdf.getImageProperties(imgData);
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
            pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
            pdf.save("informe-padel.pdf");
            setIsGeneratingPdf(false);
            showConfirmationModal("PDF generado con éxito.", null);
        }).catch(error => {
          console.error("Error al generar el PDF:", error);
          setIsGeneratingPdf(false);
          showConfirmationModal("Hubo un error al generar el PDF. Por favor, inténtalo de nuevo.", null);
        });
      };

      const textToSpeech = async (text) => {
        const payload = {
            contents: [{ parts: [{ text }] }],
            generationConfig: {
                responseModalities: ["AUDIO"],
                speechConfig: {
                    voiceConfig: { prebuiltVoiceConfig: { voiceName: "Kore" } }
                }
            },
            model: "gemini-2.5-flash-preview-tts"
        };
        const apiKey = "";
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`;

        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                throw new Error(`API call failed with status: ${response.status}`);
            }

            const result = await response.json();
            const part = result?.candidates?.[0]?.content?.parts?.[0];
            const audioData = part?.inlineData?.data;
            const mimeType = part?.inlineData?.mimeType;

            if (audioData && mimeType && mimeType.startsWith("audio/")) {
                const sampleRateMatch = mimeType.match(/rate=(\d+)/);
                const sampleRate = sampleRateMatch ? parseInt(sampleRateMatch[1], 10) : 16000;
                const pcmData = base64ToArrayBuffer(audioData);
                const pcm16 = new Int16Array(pcmData);
                const wavBlob = pcmToWav(pcm16, sampleRate);
                const audioUrl = URL.createObjectURL(wavBlob);
                const audio = new Audio(audioUrl);
                audio.play();
            } else {
                console.error("Audio data or mime type missing from response.");
            }
        } catch (error) {
            console.error("Error during Text-to-Speech:", error);
        }
      };


      const getDayFromDate = (dateString) => {
        const date = new Date(dateString + 'T00:00:00Z');
        const options = { weekday: 'long', timeZone: 'UTC' };
        return date.toLocaleDateString('es-ES', options);
      };

      return (
        <div className="bg-white p-8 rounded-2xl shadow-xl max-w-7xl w-full">
          {/* Encabezado */}
          <div className="text-center mb-8">
            <h1 className="text-4xl font-extrabold text-gray-900 mb-2">Informe de Clases de Padel</h1>
            <p className="text-gray-500 text-lg">
              Registra y gestiona tus clases diarias.
              <button
                onClick={() => textToSpeech("Informe de Clases de Padel. Registra y gestiona tus clases diarias.")}
                className="ml-2 text-gray-500 hover:text-blue-500 transition-colors"
                title="Leer en voz alta"
              >
                <i className="fas fa-volume-up"></i>
              </button>
            </p>
          </div>

          {showModal && (
            <div className="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex justify-center items-center z-50">
              <div className="bg-white p-8 rounded-lg shadow-lg max-w-sm w-full text-center">
                <p className="mb-4 text-gray-700">{modalContent}</p>
                <div className="flex justify-center space-x-4">
                  {modalAction && (
                    <button onClick={handleConfirm} className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors">
                      Confirmar
                    </button>
                  )}
                  <button onClick={handleCancel} className="bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400 transition-colors">
                    {modalAction ? 'Cancelar' : 'Cerrar'}
                  </button>
                </div>
              </div>
            </div>
          )}

          {/* Sección de Añadir/Editar Clase (ahora siempre visible) */}
          <div className="mb-8 p-6 bg-gray-100 rounded-xl shadow-inner">
              <h2 className="text-2xl font-bold text-gray-800 mb-4">
                  {isEditing ? 'Editar Clase' : 'Añadir nueva Clase'}
              </h2>
              <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
                  <div>
                      <label htmlFor="date" className="block text-sm font-medium text-gray-700">Fecha</label>
                      <input
                          type="date"
                          id="date"
                          name="date"
                          value={newEntry.date}
                          onChange={handleInputChange}
                          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
                          disabled={isEditing}
                      />
                  </div>
                  <div>
                      <label htmlFor="day" className="block text-sm font-medium text-gray-700">Día</label>
                      <select
                          id="day"
                          name="day"
                          value={newEntry.day}
                          onChange={handleInputChange}
                          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
                      >
                          <option value="">Selecciona el día</option>
                          {daysOfWeek.map(day => (
                              <option key={day} value={day}>{day}</option>
                          ))}
                      </select>
                  </div>
                  <div>
                      <label htmlFor="time" className="block text-sm font-medium text-gray-700">Horario</label>
                      <select
                          id="time"
                          name="time"
                          value={newEntry.time}
                          onChange={handleInputChange}
                          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
                      >
                          {timesOfDay.map(time => (
                              <option key={time} value={time}>{time}</option>
                          ))}
                      </select>
                  </div>
                  <div>
                      <label htmlFor="studentCount" className="block text-sm font-medium text-gray-700">Cantidad de alumnos</label>
                      <input
                          type="number"
                          id="studentCount"
                          name="studentCount"
                          value={newEntry.studentCount}
                          onChange={handleStudentCountChange}
                          min="1"
                          max="5"
                          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
                      />
                  </div>
                  <div>
                      <label htmlFor="price" className="block text-sm font-medium text-gray-700">Precio</label>
                      <input
                          type="number"
                          id="price"
                          name="price"
                          value={newEntry.price}
                          onChange={handleInputChange}
                          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
                      />
                  </div>
              </div>
              <div className="mb-4">
                  <label className="block text-sm font-medium text-gray-700 mb-2">Nombres de los alumnos</label>
                  {newEntry.studentNames.map((name, index) => (
                      <input
                          key={index}
                          type="text"
                          name={`student-name-${index}`}
                          value={name}
                          onChange={handleInputChange}
                          placeholder={`Alumno ${index + 1}`}
                          className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 mb-2"
                      />
                  ))}
              </div>
              <div className="flex space-x-4">
                  <button
                      onClick={addClass}
                      className="bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-green-700 transition-colors flex-grow"
                  >
                      {isEditing ? 'Guardar Cambios' : 'Añadir Clase'}
                  </button>
                  {isEditing && (
                      <button
                          onClick={() => { setIsEditing(false); setNewEntry({ studentCount: 1, studentNames: [''], date: new Date().toISOString().split('T')[0], day: '', time: timesOfDay[0], price: 0 }); }}
                          className="bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg shadow-md hover:bg-gray-400 transition-colors"
                      >
                          Cancelar
                      </button>
                  )}
              </div>
          </div>
        
          {/* Sección de Gestión de Clases */}
          <div className="mb-8">
            <h2 className="text-3xl font-bold text-gray-800 mb-4">Gestión de Clases</h2>
            <div className="flex flex-col sm:flex-row justify-between items-center mb-6 space-y-4 sm:space-y-0">
              <div className="flex items-center space-x-2 w-full sm:w-auto">
                <label htmlFor="dateFilter" className="text-gray-700 font-medium">Clases del día:</label>
                <input
                  type="date"
                  id="dateFilter"
                  value={selectedDate}
                  onChange={(e) => setSelectedDate(e.target.value)}
                  className="rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
                />
              </div>
              <div className="flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-4 w-full sm:w-auto">
                <div className="text-lg font-bold text-gray-700">
                  Total ingresos: <span className="text-green-600">{totalIncome.toLocaleString('es-AR', { style: 'currency', currency: 'ARS' })}</span>
                </div>
                <button
                  onClick={() => { setShowReport(false); }}
                  className="bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-blue-700 transition-colors w-full sm:w-auto"
                >
                  Ver Clases
                </button>
                <button
                  onClick={() => setShowReport(true)}
                  className="bg-purple-600 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-purple-700 transition-colors w-full sm:w-auto"
                >
                  Generar Reporte
                </button>
              </div>
            </div>

            {loading ? (
              <div className="text-center text-gray-500">Cargando clases...</div>
            ) : entries.length > 0 ? (
              <div className="card-list">
                {entries.map(entry => (
                  <div key={entry.id} className="class-card">
                    <div>
                      <div className="class-card-header">
                        <h3 className="text-xl font-bold text-gray-900">{entry.day} - {entry.time}</h3>
                        <div className="text-2xl font-extrabold text-green-600">{entry.price.toLocaleString('es-AR', { style: 'currency', currency: 'ARS' })}</div>
                      </div>
                      <div className="text-gray-700 mb-2">
                        <p className="font-semibold">Alumnos:</p>
                        <ul className="list-disc list-inside text-sm text-gray-600">
                          {entry.studentNames.map((name, index) => (
                            <li key={index}>{name}</li>
                          ))}
                        </ul>
                      </div>
                    </div>
                    <div className="flex justify-end space-x-2 mt-4">
                      <button onClick={() => editClass(entry)} className="btn-edit">
                        <i className="fas fa-edit"></i>
                      </button>
                      <button onClick={() => deleteClass(entry.id)} className="btn-delete">
                        <i className="fas fa-trash-alt"></i>
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            ) : (
              <div className="text-center text-gray-500 p-8 border-2 border-dashed border-gray-300 rounded-lg">
                No hay clases registradas para esta fecha.
              </div>
            )}
          </div>
          
          {showReport && (
            <div id="report-content" className="mt-8 p-6 bg-white rounded-xl shadow-xl">
              <h3 className="text-3xl font-bold text-gray-800 mb-4">Informe General</h3>
              <div className="grid grid-cols-1 md:grid-cols-3 gap-4 items-end mb-6">
                <div>
                  <label htmlFor="startDate" className="block text-sm font-medium text-gray-700">Fecha de inicio</label>
                  <input
                    type="date"
                    id="startDate"
                    value={reportDates.startDate}
                    onChange={(e) => setReportDates({...reportDates, startDate: e.target.value})}
                    className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                  />
                </div>
                <div>
                  <label htmlFor="endDate" className="block text-sm font-medium text-gray-700">Fecha de fin</label>
                  <input
                    type="date"
                    id="endDate"
                    value={reportDates.endDate}
                    onChange={(e) => setReportDates({...reportDates, endDate: e.target.value})}
                    className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                  />
                </div>
                <button onClick={generateReport} className="btn-action">
                  Generar Informe
                </button>
              </div>

              {reportData.entries.length > 0 && (
                <div>
                  <div className="text-lg font-semibold text-gray-700 mb-4">
                    <p>Clases en el período: <span className="text-blue-600 font-bold">{reportData.classCount}</span></p>
                    <p>Ingresos totales: <span className="text-green-600 font-bold">{reportData.totalIncome.toLocaleString('es-AR', { style: 'currency', currency: 'ARS' })}</span></p>
                  </div>
                  <div className="overflow-x-auto rounded-lg shadow-md">
                    <table className="min-w-full divide-y divide-gray-200">
                      <thead className="bg-gray-50">
                        <tr>
                          <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha</th>
                          <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Día / Horario</th>
                          <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Alumnos</th>
                          <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Precio</th>
                        </tr>
                      </thead>
                      <tbody className="bg-white divide-y divide-gray-200">
                        {reportData.entries.map((entry) => (
                          <tr key={entry.id}>
                            <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{entry.date}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{entry.day} - {entry.time}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                              {entry.studentNames.join(', ')}
                            </td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{entry.price.toLocaleString('es-AR', { style: 'currency', currency: 'ARS' })}</td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                  <div className="mt-6 text-right">
                    <button onClick={generatePDF} className="btn-export" disabled={isGeneratingPdf}>
                      {isGeneratingPdf ? 'Generando PDF...' : 'Exportar a PDF'}
                    </button>
                  </div>
                </div>
              )}
            </div>
          )}

          {/* Pie de página con el ID de usuario */}
          {userId && (
            <div className="mt-8 text-center text-gray-500">
              ID de Usuario: <span className="font-mono">{userId}</span>
            </div>
          )}
        </div>
      );
    };

    // Renderizar la aplicación
    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
